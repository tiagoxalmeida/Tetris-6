// ProjetoFuncoes.cpp : This file contains the 'main' function. Program execution begins and ends there.
//
#include <stdlib.h>
#include <stdio.h>
#include <time.h>
int colunas = 10;
int linhas = 20;
int posx = 0;
int posy = 0;
int score = 0;
bool inserir_peça_r(int p, int ang, int* mapa) {//p representa qual das 7 peças será desenhada e o ang representa qual o angulo inicial da peça
    if (p == 1) {
        if (ang == 1 || ang == 3) { //assumi que o angulo 1 é o horizontal
            if (colunas < posx + 4) {
                posx = colunas - 4;//isto pq assumi q a posição do player e o quadrado mais a esquerda
            }
            for (int l = 0; l < 4; l++) {
                if (mapa[(posy) * colunas + posx + l] != 0) {
                    return false;
                }
                mapa[(posy) * colunas + posx + l] = 11;
            }
            return true;
        }
        if (ang == 2 || ang == 4) {
            for (int x = 0; x < 4; x++) {
                if (mapa[(posy) * colunas + posx - x * colunas] != 0) {//verifica se ha quatro espaços para baixo na posicaox do player
                    return false;
                }
                mapa[(posy) * colunas + posx - x * colunas] = 11;
            }
            return true;
        }
        return false;
    }
    if (p == 2) {
        if (ang == 1) {
            if (colunas < posx + 3) {
                posx = colunas - 3;
            }
            if (mapa[(posy) * colunas + posx] != 0 && mapa[(posy)*colunas + posx] != 12) {
                return false;
            }
            mapa[(posy) * colunas + posx] = 12;
            if (posy - 1 < 0) {
                return false;
            }
            for (int l = 0; l < 3; l++) {
                if (mapa[(posy-1) * colunas + posx + l] != 0) {
                    return false;
                }
                mapa[(posy-1) * colunas + posx + l] = 12;
            }
        }
        if (ang == 2) {
            if (colunas < posx + 2) {
                posx = colunas - 2;
            }
            if (mapa[(posy) * colunas + posx] != 0 || mapa[(posy) * colunas + posx + 1] != 0) {
                return false;
            }
            if (posy - 1 < 0 || posy - 2 < 0) {
                return false;
            }
            mapa[(posy) * colunas + posx] = 12;
            mapa[(posy) * colunas + posx + 1] = 12;
            if ((mapa[(posy-1) * colunas + posx] != 0 && mapa[(posy-1) * colunas + posx] != 12) || (mapa[(posy-2) * colunas + posx] != 0 && mapa[(posy-2) * colunas + posx] != 12)) {
                return false;
            }
            mapa[(posy-1) * colunas + posx] = 12;
            mapa[(posy-2) * colunas + posx] = 12;
            return true;
        }
        if (ang == 3) {
            if (posx < 2) {
                posx = 2;
            }
            for (int l = 0; l < 3; l++) {
                if (mapa[(posy) * colunas + posx - l] != 0 && mapa[(posy - 1) * colunas + posx] != 12) {
                    return false;
                }
                mapa[(posy) * colunas + posx - l] = 12;
            }
            if (posy - 1 < 0) {
                return false;
            }
            if (mapa[(posy-1) * colunas + posx] != 0 && mapa[(posy - 1) * colunas + posx] != 12) {
                return false;
            }
            mapa[(posy-1) * colunas + posx] = 12;
            return true;
        }
        if (ang == 4) {
            if (colunas < posx + 2) {
                posx = colunas - 2;
            }
            for (int l = 1; l < 4; l++) {
                if (mapa[(posy +1 - l) * colunas + posx + 1] != 0 || posy + 1 - l < 0) {
                    printf("DSAadsdasadasd");
                    return false;
                }
                mapa[(posy+1 - l) * colunas + posx + 1] = 12;
            }
            if (mapa[(posy-2) * colunas + posx] != 0 && mapa[(posy - 2) * colunas + posx] != 12) {
                printf("Asdasd");
                return false;
            }
            mapa[(posy -2) * colunas + posx] = 12;
            printf("Asassaa");
            return true;
        }

    }
    if (p == 3) {
        if (ang == 1) {
            if (posx - 3 < -1) {
                posx = 2;
            }
            if (mapa[(posy) * colunas + posx] != 0||posy - 1 < 0) {
                return false;
            }
            mapa[(posy) * colunas + posx] = 13;
            for (int l = 0; l < 3; l++) {
                if (mapa[(posy-1) * colunas + posx - l] != 0 || posy - l +1 < 0) {
                    return false;
                }
                mapa[(posy-1) * colunas + posx - l] = 13;
            }
            return true;
        }
        if (ang == 2) {
            if (posx == 0) {
                posx = 1;
            }
            if (mapa[(posy-2) * colunas + posx] != 0 || posy - 2 < 0) {
                return false;
            }
            mapa[(posy-2) * colunas + posx] = 13;
            for (int l = 1; l < 4; l++) {
                if (mapa[(posy- l + 1) * colunas + posx - 1] != 0 || posy - l +1 < 0) {
                    return false;
                }
                mapa[(posy- l +1) * colunas + posx - 1] = 13;
            }
            return true;
        }
        if (ang == 3) {
            if (colunas < posx + 3) {
                posx = colunas - 3;
            }
            if (mapa[(posy-1) * colunas + posx] != 0 || posy - 1 < 0) {
                return false;
            }
            mapa[(posy-1) * colunas + posx] = 13;
            for (int l = 0; l < 3; l++) {
                if (mapa[(posy) * colunas + posx + l] != 0) {
                    return false;
                }
                mapa[(posy) * colunas + posx + l] = 13;
            }
            return true;
        }
        if (ang == 4) {
            if (posx == colunas - 1) {
                posx = colunas - 2;
            }
            if (mapa[(posy) * colunas + posx] != 0) {
                return false;
            }
            mapa[(posy) * colunas + posx] = 13;
            for (int l = 0; l < 3; l++) {
                if (mapa[(posy- l) * colunas + posx + 1] != 0 || posy - l < 0) {
                    return false;
                }
                mapa[(posy- l) * colunas + posx + 1] = 13;
            }
            return true;
        }
    }
    if (p == 4) {
        if (colunas < posx + 2) {
            posx = colunas - 2;
        }
        if (mapa[(posy) * colunas + posx + 1] != 0 || mapa[(posy) * colunas + posx] != 0) {
            return false;
        }
        mapa[(posy) * colunas + posx + 1] = 14;
        mapa[(posy) * colunas + posx] = 14;
        if (mapa[(posy-1) * colunas + posx + 1] != 0 || mapa[(posy-1) * colunas + posx] != 0 || posy -  1 < 0) {
            return false;
        }
        mapa[(posy-1) * colunas + posx + 1] = 14;
        mapa[(posy-1) * colunas + posx] = 14;
        return true;
    }
    if (p == 5) {
        if (ang == 1 || ang == 3) {
            if (colunas < posx + 3) {
                posx = colunas - 3;
            }
            if (mapa[colunas * (posy) + posx] != 0 || mapa[colunas * (posy) + posx + 1] != 0) {
                return false;
            }
            mapa[colunas * (posy) + posx] = 15;
            mapa[colunas * (posy) + posx + 1] = 15;
            if (mapa[colunas * (posy-1) + posx + 2] != 0 || mapa[colunas * (posy-1) + posx + 1] != 0 || posy - 1 < 0) {
                return false;
            }
            mapa[colunas * (posy-1) + posx + 2] = 15;
            mapa[colunas * (posy-1) + posx + 1] = 15;
            return true;
        }
        if (ang == 2 || ang == 4) {
            if (posx == 0) {
                posx = 1;
            }
            if (mapa[colunas * (posy) + posx] != 0 || mapa[colunas * (posy - 1) + posx] != 0 || posy - 1 < 0) {
                return false;
            }
            mapa[colunas * (posy) + posx] = 15;
            mapa[colunas * (posy-1) + posx] = 15;
            if (mapa[colunas * (posy-1) + posx - 1] != 0 || mapa[colunas * (posy-2) + posx - 1] != 0 || posy - 2 < 0) {
                return false;
            }
            mapa[colunas * (posy- 2) + posx - 1] = 15;
            mapa[colunas * (posy - 1) + posx - 1] = 15;
            return true;
        }
    }
    if (p == 6) {
        if (ang == 1 || ang == 3) {
            if (colunas < posx + 3) {
                posx = colunas - 3;
            }
            if (mapa[colunas * (posy-1) + posx] != 0 || mapa[colunas * (posy-1) + posx + 1] != 0 || posy - 1 < 0) {
                return false;
            }
            mapa[colunas * (posy-1) + posx] = 16;
            mapa[colunas * (posy-1) + posx + 1] = 16;
            if (mapa[colunas * (posy) + posx + 1] != 0 || mapa[colunas * (posy) + posx + 2] != 0) {
                return false;
            }
            mapa[colunas * (posy) + posx + 1] = 16;
            mapa[colunas * (posy) + posx + 2] = 16;
            return true;
        }
        if (ang == 2 || ang == 4) {
            if (posx == colunas - 1) {
                posx = colunas - 2;
            }
            if (mapa[colunas * (posy) + posx] != 0 || mapa[colunas * (posy-1) + posx] != 0 || posy - 1 < 0) {
                return false;
            }
            mapa[colunas * (posy) + posx] = 16;
            mapa[colunas * (posy - 1) + posx] = 16;
            if (mapa[colunas * (posy-1) + posx + 1] != 0 || mapa[colunas * (posy - 2) + posx + 1] != 0 || posy -2 < 0) {
                return false;
            }
            mapa[colunas * (posy - 2) + posx + 1] = 16;
            mapa[colunas * (posy - 1) + posx + 1] = 16;
            return true;
        }
    }
    if (p == 7) {
        if (ang == 1) {
            if (posx == 0) {
                posx = 1;
            }
            if (posx == colunas - 1) {
                posx = colunas - 2;
            }
            if (mapa[colunas * (posy) + posx] != 0 || mapa[colunas * (posy- 1) + posx] != 0 || posy - 1 < 0) {
                return false;
            }
            mapa[colunas * (posy) + posx] = 17;
            mapa[colunas * (posy-1) + posx] = 17;
            if (mapa[colunas * (posy-1) + posx + 1] != 0 || mapa[colunas * (posy-1) + posx - 1] != 0) {
                return false;
            }
            mapa[colunas * (posy-1) + posx + 1] = 17;
            mapa[colunas * (posy-1) + posx - 1] = 17;
            return true;
        }
        if (ang == 2) {
            if (posx == 0) {
                posx = 1;
            }
            if (mapa[colunas * (posy-1) + posx] != 0 || mapa[colunas * (posy-1) + posx - 1] != 0) {
                return false;
            }
            mapa[colunas * (posy-1) + posx] = 17;
            mapa[colunas * (posy-1) + posx - 1] = 17;
            if (mapa[colunas * (posy) + posx - 1] != 0 || mapa[colunas * (posy-2) + posx - 1] != 0 || posy - 2 < 0) {
                return false;
            }
            mapa[colunas * (posy) + posx - 1] = 17;
            mapa[colunas * (posy-2) + posx - 1] = 17;
            return true;
        }
        if (ang == 3) {
            if (posx == 0) {
                posx = 1;
            }
            if (posx == 9) {
                posx = 8;
            }
            if (mapa[colunas * (posy) + posx] != 0 || mapa[colunas * (posy-1) + posx] != 0 || posy - 1 < 0) {
                return false;
            }
            mapa[colunas * (posy) + posx] = 17;
            mapa[colunas * (posy-1) + posx] = 17;
            if (mapa[colunas * (posy) + posx + 1] != 0 || mapa[colunas * (posy) + posx - 1] != 0) {
                return false;
            }
            mapa[colunas * (posy) + posx + 1] = 17;
            mapa[colunas * (posy) + posx - 1] = 17;
            return true;
        }
        if (ang == 4) {
            if (posx == colunas - 1) {
                posx = colunas - 2;
            }
            if (mapa[colunas * (posy-1) + posx] != 0 || mapa[colunas * (posy-1) + posx + 1] != 0 || posy - 1 < 0) {
                return false;
            }
            mapa[colunas * (posy-1) + posx] = 17;
            mapa[colunas * (posy-1) + posx + 1] = 17;
            if (mapa[colunas * (posy) + posx - 1] != 0 || mapa[colunas * (posy-2) + posx - 1] != 0 || posy - 2 < 0) {
                return false;
            }
            mapa[colunas * (posy) + posx + 1] = 17;
            mapa[colunas * (posy-2) + posx + 1] = 17;
            return true;
        }
    }
    if (p < 1 || 7 < p) {
        return false;
    }
}
int quantos_espaços_linha(int* mapa, int linha) {
    int c = 0;
    for (int x = 0; x < colunas; x++) {
        if (mapa[linha * colunas + x] == 0) {
            c++;
        }
    }
    return c;
}
void pontuaçao(int x) {
    if (x == 1) {
        score = score + 80;
    }
    if (x == 2) {
        score = score +20;
    }
    if (x == 3) {
        score = score + 200;
    }
    if (x == 4) {
        score = score + 900;
    }
    if (4 < x) {
        score = score + 500;
    }
}
void remove_andamento(int * mapa) {
    int q = 0;
    for (int i = 0; i < linhas * colunas; i++) {
        if (mapa[i] / 10 == 1) {
            q++;
            mapa[i] = 0;
        }
        if (q == 4) {
            break;
        }
    }
}
bool inserir_peça(int p, int ang, int* mapa) {//p representa qual das 7 peças será desenhada e o ang representa qual o angulo inicial da peça
    if (p == 1) {
        if (ang == 1 || ang == 3) { //assumi que o angulo 1 é o horizontal
            if (colunas < posx + 4) {
                posx = colunas - 4;//isto pq assumi q a posição do player e o quadrado mais a esquerda
            }
            for (int l = 0; l < 4; l++) {
                if (mapa[(linhas - 1) * colunas + posx + l] != 0) {
                    return false;
                }
                mapa[(linhas - 1) * colunas + posx + l] = 11;
            }
            return true;
        }
        if (ang == 2 || ang == 4) {
            for (int x = 0; x < 4; x++) {
                if (mapa[(linhas - 1) * colunas + posx - x * colunas] != 0) {//verifica se ha quatro espaços para baixo na posicaox do player
                    return false;
                }
                mapa[(linhas - 1) * colunas + posx - x * colunas] = 11;
            }
            return true;
        }
        return false;
    }
    if (p == 2) {
        if (ang == 1) {
            if (colunas < posx + 3) {
                posx = colunas - 3;
            }
            if (mapa[(linhas - 1) * colunas + posx] != 0) {
                return false;
            }
            mapa[(linhas - 1) * colunas + posx] = 12;
            for (int l = 0; l < 3; l++) {
                if (mapa[(linhas - 2) * colunas + posx + l] != 0) {
                    return false;
                }
                mapa[(linhas - 2) * colunas + posx + l] = 12;
            }
        }
        if (ang == 2) {
            if (colunas < posx + 2) {
                posx = colunas - 2;
            }
            if (mapa[(linhas - 1) * colunas + posx] != 0 || mapa[(linhas - 1) * colunas + posx + 1] != 0) {
                return false;
            }
            mapa[(linhas - 1) * colunas + posx] = 12;
            mapa[(linhas - 1) * colunas + posx + 1] = 12;
            if (mapa[(linhas - 2) * colunas + posx] != 0 || mapa[(linhas - 3) * colunas + posx] != 0) {
                return false;
            }
            mapa[(linhas - 2) * colunas + posx] = 12;
            mapa[(linhas - 3) * colunas + posx] = 12;
            return true;
        }
        if (ang == 3) {
            if (posx < 2) {
                posx = 2;
            }
            for (int l = 0; l < 3; l++) {
                if (mapa[(linhas - 1) * colunas + posx - l] != 0) {
                    return false;
                }
                mapa[(linhas - 1) * colunas + posx - l] = 12;
            }
            if (mapa[(linhas - 2) * colunas + posx] != 0) {
                return false;
            }
            mapa[(linhas - 2) * colunas + posx] = 12;
            return true;
        }
        if (ang == 4) {
            if (colunas < posx + 2) {
                posx = colunas - 2;
            }
            for (int l = 1; l < 4; l++) {
                if (mapa[(linhas - l) * colunas + posx + 1] != 0) {
                    printf("aqui %d \n", (linhas - l) * colunas + posx + 1);
                    return false;
                }
                mapa[(linhas - l) * colunas + posx + 1] = 12;
            }
            if (mapa[(linhas - 2) * colunas + posx] != 0) {
                return false;
            }
            mapa[(linhas - 3) * colunas + posx] = 12;
            return true;
        }

    }
    if (p == 3) {
        if (ang == 1) {
            if (posx - 3 < -1) {
                posx = 2;
            }
            if (mapa[(linhas - 1) * colunas + posx] != 0) {
                return false;
            }
            mapa[(linhas - 1) * colunas + posx] = 13;
            for (int l = 0; l < 3; l++) {
                if (mapa[(linhas - 2) * colunas + posx - l] != 0) {
                    return false;
                }
                mapa[(linhas - 2) * colunas + posx - l] = 13;
            }
            return true;
        }
        if (ang == 2) {
            if (posx == 0) {
                posx = 1;
            }
            if (mapa[(linhas - 3) * colunas + posx] != 0) {
                return false;
            }
            mapa[(linhas - 3) * colunas + posx] = 13;
            for (int l = 1; l < 4; l++) {
                if (mapa[(linhas - l) * colunas + posx - 1] != 0) {
                    return false;
                }
                mapa[(linhas - l) * colunas + posx - 1] = 13;
            }
            return true;
        }
        if (ang == 3) {
            if (colunas < posx + 3) {
                posx = colunas - 3;
            }
            if (mapa[(linhas - 2) * colunas + posx] != 0) {
                return false;
            }
            mapa[(linhas - 2) * colunas + posx] = 13;
            for (int l = 0; l < 3; l++) {
                if (mapa[(linhas - 1) * colunas + posx + l] != 0) {
                    return false;
                }
                mapa[(linhas - 1) * colunas + posx + l] = 13;
            }
            return true;
        }
        if (ang == 4) {
            if (posx == colunas - 1) {
                posx = colunas - 2;
            }
            if (mapa[(linhas - 1) * colunas + posx] != 0) {
                return false;
            }
            mapa[(linhas - 1) * colunas + posx] = 13;
            for (int l = 0; l < 3; l++) {
                if (mapa[(linhas - 1 - l) * colunas + posx + 1] != 0) {
                    return false;
                }
                mapa[(linhas - 1 - l) * colunas + posx + 1] = 13;
            }
            return true;
        }
    }
    if (p == 4) {
        if (colunas < posx + 2) {
            posx = colunas - 2;
        }
        if (mapa[(linhas - 1) * colunas + posx + 1] != 0 || mapa[(linhas - 1) * colunas + posx] != 0) {
            return false;
        }
        mapa[(linhas - 1) * colunas + posx + 1] = 14;
        mapa[(linhas - 1) * colunas + posx] = 14;
        if (mapa[(linhas - 2) * colunas + posx + 1] != 0 || mapa[(linhas - 2) * colunas + posx] != 0) {
            return false;
        }
        mapa[(linhas - 2) * colunas + posx + 1] = 14;
        mapa[(linhas - 2) * colunas + posx] = 14;
        return true;
    }
    if (p == 5) {
        if (ang == 1 || ang == 3) {
            if (colunas < posx + 3) {
                posx = colunas - 3;
            }
            if (mapa[colunas * (linhas - 1) + posx] != 0 || mapa[colunas * (linhas - 1) + posx + 1] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 1) + posx] = 15;
            mapa[colunas * (linhas - 1) + posx + 1] = 15;
            if (mapa[colunas * (linhas - 2) + posx + 2] != 0 || mapa[colunas * (linhas - 2) + posx + 1] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 2) + posx + 2] = 15;
            mapa[colunas * (linhas - 2) + posx + 1] = 15;
            return true;
        }
        if (ang == 2 || ang == 4) {
            if (posx == 0) {
                posx = 1;
            }
            if (mapa[colunas * (linhas - 1) + posx] != 0 || mapa[colunas * (linhas - 2) + posx] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 1) + posx] = 15;
            mapa[colunas * (linhas - 2) + posx] = 15;
            if (mapa[colunas * (linhas - 2) + posx - 1] != 0 || mapa[colunas * (linhas - 3) + posx - 1] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 2) + posx - 1] = 15;
            mapa[colunas * (linhas - 3) + posx - 1] = 15;
            return true;
        }
    }
    if (p == 6) {
        if (ang == 1 || ang == 3) {
            if (colunas < posx + 3) {
                posx = colunas - 3;
            }
            if (mapa[colunas * (linhas - 2) + posx] != 0 || mapa[colunas * (linhas - 2) + posx + 1] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 2) + posx] = 16;
            mapa[colunas * (linhas - 2) + posx + 1] = 16;
            if (mapa[colunas * (linhas - 1) + posx + 1] != 0 || mapa[colunas * (linhas - 1) + posx + 2] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 1) + posx + 1] = 16;
            mapa[colunas * (linhas - 1) + posx + 2] = 16;
            return true;
        }
        if (ang == 2 || ang == 4) {
            if (posx == colunas - 1) {
                posx = colunas - 2;
            }
            if (mapa[colunas * (linhas - 1) + posx] != 0 || mapa[colunas * (linhas - 2) + posx] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 1) + posx] = 16;
            mapa[colunas * (linhas - 2) + posx] = 16;
            if (mapa[colunas * (linhas - 2) + posx + 1] != 0 || mapa[colunas * (linhas - 3) + posx + 1] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 2) + posx + 1] = 16;
            mapa[colunas * (linhas - 3) + posx + 1] = 16;
            return true;
        }
    }
    if (p == 7) {
        if (ang == 1) {
            if (posx == 0) {
                posx = 1;
            }
            if (posx == colunas - 1) {
                posx = colunas - 2;
            }
            if (mapa[colunas * (linhas - 1) + posx] != 0 || mapa[colunas * (linhas - 2) + posx] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 1) + posx] = 17;
            mapa[colunas * (linhas - 2) + posx] = 17;
            if (mapa[colunas * (linhas - 2) + posx + 1] != 0 || mapa[colunas * (linhas - 2) + posx - 1] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 2) + posx + 1] = 17;
            mapa[colunas * (linhas - 2) + posx - 1] = 17;
            return true;
        }
        if (ang == 2) {
            if (posx == 0) {
                posx = 1;
            }
            if (mapa[colunas * (linhas - 2) + posx] != 0 || mapa[colunas * (linhas - 2) + posx - 1] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 2) + posx] = 17;
            mapa[colunas * (linhas - 2) + posx - 1] = 17;
            if (mapa[colunas * (linhas - 1) + posx - 1] != 0 || mapa[colunas * (linhas - 3) + posx - 1] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 1) + posx - 1] = 17;
            mapa[colunas * (linhas - 3) + posx - 1] = 17;
            return true;
        }
        if (ang == 3) {
            if (posx == 0) {
                posx = 1;
            }
            if (posx == 9) {
                posx = 8;
            }
            if (mapa[colunas * (linhas - 1) + posx] != 0 || mapa[colunas * (linhas - 2) + posx] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 1) + posx] = 17;
            mapa[colunas * (linhas - 2) + posx] = 17;
            if (mapa[colunas * (linhas - 1) + posx + 1] != 0 || mapa[colunas * (linhas - 1) + posx - 1] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 1) + posx + 1] = 17;
            mapa[colunas * (linhas - 1) + posx - 1] = 17;
            return true;
        }
        if (ang == 4) {
            if (posx == colunas - 1) {
                posx = colunas - 2;
            }
            if (mapa[colunas * (linhas - 2) + posx] != 0 || mapa[colunas * (linhas - 2) + posx + 1] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 2) + posx] = 17;
            mapa[colunas * (linhas - 2) + posx + 1] = 17;
            if (mapa[colunas * (linhas - 1) + posx - 1] != 0 || mapa[colunas * (linhas - 3) + posx - 1] != 0) {
                return false;
            }
            mapa[colunas * (linhas - 1) + posx + 1] = 17;
            mapa[colunas * (linhas - 3) + posx + 1] = 17;
            return true;
        }
    }
    else { return false; }
}
bool rotacoes(int p, int* mapa, int ang, int lado) {
	int cima = 0;
	int baixo = 0;
	remove_andamento(mapa);
	if (ang + lado == 5) {
		cima = 1;
		ang = 1;
		lado = 0;
	}
	if (ang + lado == 0) {
		baixo = 1;
		ang = 4;
		lado = 0;
	}
	if (!inserir_peca_r(p, ang + lado, mapa)) {
		if (cima == 1) {
			printf("d1\n");
			remove_andamento(mapa);
			ang = 4;
			inserir_peca_r(p, ang, mapa);
		}
		if (baixo == 1) {
			printf("d2\n");
			remove_andamento(mapa);
			ang = 1;
			inserir_peca_r(p, ang, mapa);
		}
		if (baixo == 0 && cima == 0) {
			printf("d3\n");
			remove_andamento(mapa);
			inserir_peca_r(p, ang, mapa);
		}
		return false;
	}
	return true;
}
bool anda_baixo(int* mapa) {
    int p1 = -1, p2 = -1, p3 = -1, p4 = -1, c = 0;
    for (int i = colunas * linhas - 1; -1 < i; i--) {
        if (mapa[i] / 10 != 0) {
            if (c == 0) {
                p1 = i;
            }
            if (c == 1) {
                p2 = i;
            }
            if (c == 2) {
                p3 = i;
            }
            if (c == 3) {
                p4 = i;
            }
            c++;
        }
        if (c == 4) {
            break;
        }
    }
    if (p1< colunas || p2 < colunas || p3 < colunas || p4 < colunas) {
    
        mapa[p1] = mapa[p1] % 10;
        mapa[p2] = mapa[p2] % 10;
        mapa[p3] = mapa[p3] % 10;
        mapa[p4] = mapa[p4] % 10;
        return false;
        }
        if (mapa[p1 - colunas] != 0 && mapa[p1 - colunas] != mapa[p1] ) {
            
            mapa[p1] = mapa[p1] % 10;
            mapa[p2] = mapa[p2] % 10;
            mapa[p3] = mapa[p3] % 10;
            mapa[p4] = mapa[p4] % 10;
            return false;
        }
        if (mapa[p2 - colunas] != 0 && mapa[p2 - colunas] != mapa[p2] ) {
           
            mapa[p1] = mapa[p1] % 10;
            mapa[p2] = mapa[p2] % 10;
            mapa[p3] = mapa[p3] % 10;
            mapa[p4] = mapa[p4] % 10;
            return false;
        }
        if (mapa[p3 - colunas] != 0 && mapa[p3 - colunas] != mapa[p3] ) {
         
            mapa[p1] = mapa[p1] % 10;
            mapa[p2] = mapa[p2] % 10;
            mapa[p3] = mapa[p3] % 10;
            mapa[p4] = mapa[p4] % 10;
            return false;
        }
        if (mapa[p4 - colunas] != 0 && mapa[p4 - colunas] != mapa[p4] ) {
        
            mapa[p1] = mapa[p1] % 10;
            mapa[p2] = mapa[p2] % 10;
            mapa[p3] = mapa[p3] % 10;
            mapa[p4] = mapa[p4] % 10;
            return false;
        }
        int aux1 = mapa[p1], aux2 = mapa[p2], aux3 = mapa[p3], aux4 = mapa[p4];
        mapa[p1] = 0; mapa[p2] = 0; mapa[p3] = 0; mapa[p4] = 0;
        mapa[p1 - colunas] = aux1; mapa[p2 - colunas] = aux2; mapa[p3 - colunas] = aux3; mapa[p4 - colunas] = aux4;
        
        return true;
    
}
bool anda_esquerda(int* mapa) {
    int p1 = -1, p2 = -1, p3 = -1, p4 = -1, c = 0;
    for (int i = colunas * linhas - 1; -1 < i; i--) {
        if (mapa[i] / 10 != 0) {
            if (c == 0) {
                p1 = i;
            }
            if (c == 1) {
                p2 = i;
            }
            if (c == 2) {
                p3 = i;
            }
            if (c == 3) {
                p4 = i;
            }
            c++;
        }
        if (c == 4) {
            break;
        }
    }
    if (p1 % 10 == 0 || p2 % 10 == 0 || p3 % 10 == 0 || p4 % 10 == 0) {
 
        return false;
    }
    if (mapa[p1 - 1] != 0 && mapa[p1 - 1] != mapa[p1]) {
     
        return false;
    }
    if (mapa[p2 - 1] != 0 && mapa[p2 - 1] != mapa[p2]) {
      
        return false;
    }
    if (mapa[p3 - 1] != 0 && mapa[p3 - 1] != mapa[p3]) {
 
        return false;
    }
    if (mapa[p4 - 1] != 0 && mapa[p4 - 1] != mapa[p4]) {
   
        return false;
    }
    int aux1 = mapa[p1], aux2 = mapa[p2], aux3 = mapa[p3], aux4 = mapa[p4];
    mapa[p1] = 0; mapa[p2] = 0; mapa[p3] = 0; mapa[p4] = 0;
    mapa[p1 - 1] = aux1; mapa[p2 - 1] = aux2; mapa[p3 - 1] = aux3; mapa[p4 - 1] = aux4;

    return true;

}
bool anda_direita(int* mapa) {
    //precisa de alterações se o numero das colunas for superior a 10
    int p1 = -1, p2 = -1, p3 = -1, p4 = -1, c = 0;
    for (int i = colunas * linhas - 1; -1 < i; i--) {
        if (mapa[i] / 10 != 0) {
            if (c == 0) {
                p1 = i;
            }
            if (c == 1) {
                p2 = i;
            }
            if (c == 2) {
                p3 = i;
            }
            if (c == 3) {
                p4 = i;
            }
            c++;
        }
        if (c == 4) {
            break;
        }
    }
    if (p1 % 10 == colunas -1 || p2 % 10 == colunas - 1 || p3 % 10 == colunas -1 || p4 % 10 == colunas -1) {
      
        return false;
    }
    if (mapa[p1  +1] != 0 && mapa[p1 + 1] != mapa[p1]) {
       
        return false;
    }
    if (mapa[p2 + 1] != 0 && mapa[p2 + 1] != mapa[p2]) {
       ;
        return false;
    }
    if (mapa[p3 + 1] != 0 && mapa[p3 + 1] != mapa[p3]) {
      
        return false;
    }
    if (mapa[p4 + 1] != 0 && mapa[p4 + 1] != mapa[p4]) {
       
        return false;
    }
    int aux1 = mapa[p1], aux2 = mapa[p2], aux3 = mapa[p3], aux4 = mapa[p4];
    mapa[p1] = 0; mapa[p2] = 0; mapa[p3] = 0; mapa[p4] = 0;
    mapa[p1 + 1] = aux1; mapa[p2 + 1] = aux2; mapa[p3 + 1] = aux3; mapa[p4 + 1] = aux4;

    return true;
}
void display_mapa(int* mapa) {
    for (int i = 0; i < colunas * linhas; i++) {
        printf("%d ", mapa[i]);
        if ((i + 1) % colunas == 0) {
            printf("\n");
        }
    }
}
bool linha_vazia(int* mapa, int linha) {
    for (int x = 0; x < colunas; x++) {
        if (mapa[linha * colunas + x] != 0) {
            return false;
        }
    }
    return true;
}//temos de ter cuidado para nunca chamarmos esta funçao com a linha errada(exemplo haver 20 linhas e chamarmos a 20 da mal pq começa na 0)
bool linha_cheia(int* mapa, int linha) {
    if (linha < 0 || linhas - 1 < linha) {
        return false;
    }
    for (int x = 0; x < colunas; x++) {
        if (mapa[linha * colunas + x] == 0) {
            return false;
        }
    }
    return true;
}//temos de ter cuidado para nunca chamarmos esta funçao com a linha errada(exemplo haver 20 linhas e chamarmos a 20 da mal pq começa na 0)
void substitui_linha(int* mapa, int l1, int l2) {
    for (int x = 0; x < colunas; x++) {
        mapa[l1 * colunas + x] = mapa[l2 * colunas + x];
    }
}
void apaga_linha(int* mapa, int linha) {
    for (int i = linha; i < linhas - 1; i++) {
        substitui_linha(mapa, i, i + 1);
    }
    for (int c = 0; c < colunas; c++) {
        mapa[colunas * (linhas - 1) + c] = 0;
    }
}
int* create_fila() {
    time_t timer;
    struct tm y2k = { 0 };
    double seconds;
    y2k.tm_hour = 0;   y2k.tm_min = 0; y2k.tm_sec = 0;
    y2k.tm_year = 100; y2k.tm_mon = 4; y2k.tm_mday = 9;

    int * fila = (int*)calloc(4, sizeof(int));
 
        time(&timer);  
        seconds = difftime(timer, mktime(&y2k));
        int y = (int)(seconds + 0.5);
        printf("%d\n", y);
        fila[0] = y % 10;
        fila[1] = y / 100 % 10;
        fila[2] = y / 1000 % 10 % 10;
        fila[3] = y / 10 % 10;
        if (y % 10 == 0 || y %10== 8 || y %10 == 9) {
            fila[0] = rand() % 7 + 1;
        }
        if (y /100 % 10 == 0 || y /100 % 10 == 8 || y/100 % 10 == 9) {
            fila[1] = rand() % 7 + 1;
        }
        if (y / 1000 % 10 % 10 == 0 || y / 1000 % 10 % 10 == 8 || y / 1000 % 10 % 10 == 9) {
            fila[2] = rand() % 7 + 1;
        }
        if (y / 10 % 10 == 0 || y /10 % 10 == 8 || y / 10 % 10 == 9) {
            fila[3] = rand() % 7 + 1;
        }
   
    
    return fila;
}
void anda_fila(int* fila) {
    
    for (int i = 0; i < 4-1; i++) {
        fila[i] = fila[i + 1];
    }
    time_t timer;
    struct tm y2k = { 0 };
    double seconds;
    y2k.tm_hour = 0;   y2k.tm_min = 0; y2k.tm_sec = 0;
    y2k.tm_year = 100; y2k.tm_mon = 4; y2k.tm_mday = 9;


    time(&timer);
    seconds = difftime(timer, mktime(&y2k));
    int y = (int)(seconds + 0.5);
    if (y == 0 || y == 8 || y == 9) {
        y = rand() % 7 + 1;
    }
    fila[4 - 1] =y%10;
}
void anda_auxiliar(int* aux) {
    for (int i = 2; i < 8; i++) {
        aux[i - 2] = aux[i];
        aux[i - 2 + 8] = aux[i + 8];
        aux[i - 2 + 16] = aux[i + 16];
        aux[i - 2 + 24] = aux[i + 24];
        aux[i] = 0;
        aux[i + 8] = 0;
        aux[i + 16] = 0;
        aux[i + 24] = 0;
    }
}
void inserir_auxiliar(int* aux, int p) {
    if (p == 1) {
        aux[7] = 1;
        aux[15] = 1;
        aux[23] = 1;
        aux[31] = 1;
    }
    if (p == 2) {
        aux[6] = 2;
        aux[7] = 2;
        aux[15] = 2;
        aux[23] = 2;
    }
    if (p == 3) {
        aux[7] = 3;
        aux[15] = 3;
        aux[23] = 3;
        aux[22] = 3;
    }
    if (p == 4) {
        aux[7] = 4;
        aux[6] = 4;
        aux[14] = 4;
        aux[15] = 4;
    }
    if (p == 5) {
        aux[6] = 5;
        aux[14] = 5;
        aux[15] = 5;
        aux[23] = 5;
    }
    if (p == 6) {
        aux[7] = 6;
        aux[15] = 6;
        aux[16] = 6;
        aux[24] = 6;
    }
    if (p == 7) {
        aux[7] = 7;
        aux[15] = 7;
        aux[23] = 7;
        aux[14] = 7;
    }
}
int main()
{
   int * mapa = (int*)calloc(colunas * linhas, sizeof(int));
    int* auxiliar = (int*)calloc(4 * 2 * 4, sizeof(int));
    int* teste = create_fila();
    inserir_auxiliar(auxiliar, teste[0]);
    anda_auxiliar(auxiliar);
    inserir_auxiliar(auxiliar, teste[1]);
    anda_auxiliar(auxiliar);
    inserir_auxiliar(auxiliar, teste[2]);
    anda_auxiliar(auxiliar);
    inserir_auxiliar(auxiliar, teste[3]);
    int ang = rand() % 4 + 1;
    for (int x = 0; x < 4; x++) {
        printf("%d\n", teste[x]);
    }
    int clock = 0;
    clock++;
    bool glwp = true;
    bool ins = true;
    time_t timer1, timer2;
    time(&timer1);
    if ((clock % 1000 == 0 || glwp) && ins) {
        if (anda_baixo(mapa)) {
            posy = posy - 1;
        }
        else {
            if (!(linha_cheia(mapa, posy) || linha_cheia(mapa, posy + 1)) || linha_cheia(mapa, posy + 2) || linha_cheia(mapa, posy + 3) || linha_cheia(mapa, posy + -1) || linha_cheia(mapa, posy - 2) || linha_cheia(mapa, posy - 3)) {
                anda_fila(teste);
                anda_auxiliar(auxiliar);
                inserir_auxiliar(auxiliar, teste[3]);   
            }
            else {
                int pont = 0;
                for (int i = 0; i < linhas; i++) {
                    if (linha_cheia(mapa, i)) {
                        pont++;
                        apaga_linha(mapa, i);
                        pontuaçao(pont);
                        i = 0;
                    }
                    anda_fila(teste);
                    anda_auxiliar(auxiliar);
                    inserir_auxiliar(auxiliar, teste[3]);
                    ang = rand() % 4 + 1;
                    ins = inserir_peça(teste[0], ang, mapa);
                    
            }
        }
    }
    
    
    
    return 0;
}



